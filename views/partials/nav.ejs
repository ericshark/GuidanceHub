<!-- Inline navigation scripts to ensure they run regardless of auth status -->
<script>
  // Navigation functions defined at the top of the file to ensure they're available
  function toggleNav() {
    console.log('Nav toggle clicked');
    var navLinks = document.getElementById('navLinks');
    var navToggle = document.getElementById('navToggle');
    if (navLinks) {
      if (navLinks.classList.contains('active')) {
        navLinks.classList.remove('active');
      } else {
        navLinks.classList.add('active');
      }
    }
    if (navToggle) {
      if (navToggle.classList.contains('active')) {
        navToggle.classList.remove('active');
      } else {
        navToggle.classList.add('active');
      }
    }
  }
  
  function toggleUserMenu() {
    console.log('User menu toggle clicked');
    var userMenuDropdown = document.getElementById('userMenuDropdown');
    if (userMenuDropdown) {
      if (userMenuDropdown.style.display === 'block') {
        userMenuDropdown.style.display = 'none';
      } else {
        userMenuDropdown.style.display = 'block';
      }
    }
  }
  
  // Execute when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Nav script loaded and running');
    
    // Make sure click outside menu closes it
    document.addEventListener('click', function(event) {
      var userMenuBtn = document.getElementById('userMenuBtn');
      var userMenuDropdown = document.getElementById('userMenuDropdown');
      
      if (userMenuBtn && userMenuDropdown && 
          !userMenuBtn.contains(event.target) && 
          !userMenuDropdown.contains(event.target)) {
        userMenuDropdown.style.display = 'none';
      }
    });
  });
</script>

<nav>
  <div class="logo"><a href="/" style="text-decoration: none; color: inherit;">GuidanceHub</a></div>
  <div class="nav-toggle" id="navToggle" onclick="toggleNav(); return false;">
    <span></span>
    <span></span>
    <span></span>
  </div>
  <ul class="nav-links" id="navLinks">
    <li><a href="/" onclick="console.log('Home link clicked')">Home</a></li>
    <% if (user) { %>
    <li class="auth-dependent">
      <a href="/begin" onclick="console.log('Begin link clicked')">Begin</a>
    </li>
    <li class="auth-dependent">
      <a href="/conversations" onclick="console.log('Conversations link clicked')">My Conversations</a>
    </li>
    <% } %>
    <li><a href="/about" onclick="console.log('About link clicked')">About</a></li>
    <li><a href="/contact" onclick="console.log('Contact link clicked')">Contact</a></li>
  </ul>
  
  <% if(!user){ %>
  <a class="login-btn" href="/login" onclick="console.log('Login button clicked')">Login</a>
  <% } else { %>
  <div class="user-menu">
    <button class="user-menu-button" id="userMenuBtn" onclick="toggleUserMenu(); return false;">
      <img src="<%= user.photos && user.photos[0] ? user.photos[0].value : '/default-avatar.png' %>" alt="Profile" class="user-avatar" width="32" height="32">
      <span><%= user.displayName || 'User' %> <i class="menu-arrow">â–¼</i></span>
    </button>
    <div class="user-menu-dropdown" id="userMenuDropdown">
      <a href="/account" onclick="console.log('Account link clicked')">My Account</a>
      <a href="/logout" onclick="console.log('Logout link clicked')">Logout</a>
    </div>
  </div>
  <% } %>
</nav>